<?php
/**
 * Custom CTA Posts
 * 
 * Plugin Name: Custom CTA Posts
 * Description: Adiciona e edita uma sessÃ£o de CTA em todos os posts
 * Version: 0.0.3
 * Author: Thutor
 * Author URI: http://thutor.com
 */

// Exit if accessed directly.
if (!defined('ABSPATH')) {
	exit;
}

// Retrieve plugin data
$plugin_data = get_plugin_data(__FILE__);

// Draw plugin dashboard
function custom_cta_dashboard() {
    // Die if current user cannot manage options
    if (!current_user_can('manage_options')) {
        wp_die_(_('Acesso restrito'));
    }

    // Import style
    // Import javascript

    // Draw dashboard
    ?>
        <div class="wrap">
            <h1>Custom CTA on Posts</h1>
            <p>
                <?php $plugin_data ?>
                <small><em>(v 0.0.2)</em></small>
            </p>
            <hr>
            <div class="custom-cta__drag-container"></div>
        </div>
    <?php
}

// Add a new admin_menu item
function cta_custom_dashboard() {
    $title      = 'Custom CTA';
    $slug       = sanitize_title($title);
    $dashicon   = 'dashicons-carrot';

    add_menu_page(
        $title,
        $title,
        'manage_options',
        $slug,
        'custom_cta_dashboard',
        $dashicon
    );
}
add_action('admin_menu', 'cta_custom_dashboard');

// Add a custom section at the end of all posts
function add_custom_cta_section($content) {
    $content .= '<div id="custom-cta_section"></div>';

    return $content;
}
add_filter('the_content', 'add_custom_cta_section');

/**
 * Changelog
 * 
 * v0.0.1
 * - Initial set tp
 * 
 * v0.0.2
 * - Added admin menu painel with custom interface (basic)
 */
